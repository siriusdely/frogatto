{
id: "skeeter",
prototype: ["hittable"],
hitpoints: 10,
traction_in_air: 1000,
friction: 1000,
properties: {
	swallowable: "bool :: true",
	attack_damage: "1",
	team: "'evil'",

	death_fx_type: "'none'",
	death_fx_ignore_damage_type: "true",
	acquirable_item_drop_value: "5",					
	points_value: "14",

	target_close: "if(lib.math.length(x,y,_goal_x,_goal_y) < 50, 1, 0)",
	seek_target: "[add(velocity_x, cos(lib.math.angle(x,y,_goal_x,_goal_y)) * velMag),
							add(velocity_y, sin(lib.math.angle(x,y,_goal_x,_goal_y)) * velMag),
				] where velMag = 30",
	decelerate: "[set(velocity_x, velocity_x*0.8), set(velocity_y, velocity_y*0.8)]",
	delay_interval: "100*1d6",	

	//enable being grabbed
	basic_type: "me.type",
	thrown_type: "me.basic_type+'.thrown'", 
	physical_size: 8,

#-------------------------- vars --------------------------#
	_randSeed: { type: "int", init: "1d400", persistent: false },
	_goal_x: { type: "int", init: "midpoint_x", persistent: false },
	_goal_y: { type: "int", init: "midpoint_y", persistent: false },

	_x_bound: { type: "int", dynamic_initialization: true },
	_x2_bound: { type: "int", dynamic_initialization: true },
	_y_bound: { type: "int", dynamic_initialization: true },
	_y2_bound: { type: "int", dynamic_initialization: true },

},
on_create: "[set(activation_border, max(abs(_x2_bound-_x_bound), abs(_y2_bound-_y_bound))),
					animation('hover'),
					schedule(delay_interval, fire_event('warn'))]",
on_force_death: "[handle_death({damage_type: 'neutral'}),die()]",
on_enter_water: "[handle_death({damage_type: 'neutral'}),die()]",


on_warn: "[animation('warn'),schedule(20, fire_event('set_goal'))]",
on_process_warn: "if(cycle%2=0, set(brightness,4000),set(brightness,50))",
on_set_goal: "[set(_goal_x, _x_bound + 1d(zone_width)),
				set(_goal_y, _y_bound+ 1d(zone_height)),
				animation('normal'),
				set(brightness,255),
				schedule(delay_interval, fire_event('warn'))] where zone_width = (_x2_bound-_x_bound) where zone_height = (_y2_bound-_y_bound)",
on_process_normal: "[if(target_close, if(max(velocity_x,velocity_y >20),decelerate,animation('hover')), seek_target),
						facing(sign(velocity_x))]",
on_process_hover: "[set(velocity_x,sin(cycle*(8+1d3)+_randSeed)*40),set(velocity_y,sin(cycle*(10+1d3)+_randSeed)*60)]",
on_end_anim: "switch(animation,
					'hurt',animation('hover'),
					animation(animation))",
zorder: "@include data/zorder.cfg:in_front_of_parallax_objects",

animation: [
	{
		feet_x: 11,
		feet_y: 21,
		image: "enemies/skeeter.png",
		pad: 3,
		body_area: "all",
		frames: 5,
		duration: 1,
		attack_area: [15,17,17,19],
		accel_x: 0,
		accel_y: 0,
		id: "normal",
		rect: [1,1,20,24],
	},
	{
		feet_x: 11,
		feet_y: 21,
		image: "enemies/skeeter.png",
		pad: 3,
		body_area: "all",
		frames: 5,
		duration: 1,
		attack_area: [15,17,17,19],
		accel_x: 0,
		accel_y: 0,
		id: "hover",
		rect: [1,1,20,24],
	},
	{
		feet_x: 11,
		feet_y: 21,
		image: "enemies/skeeter.png",
		pad: 3,
		body_area: "all",
		frames: 5,
		duration: 1,
		attack_area: [15,17,17,19],
		accel_x: 0,
		accel_y: 0,
		id: "warn",
		rect: [1,1,20,24],
	},
	{
		feet_x: 11,
		feet_y: 21,
		image: "enemies/skeeter.png",
		pad: 3,
		body_area: "all",
		frames: 1,
		duration: 18,
		attack_area: [15,17,17,19],
		accel_x: 0,
		accel_y: 0,
		id: "hurt",
		rect: [93,28,112,51],
	},
],
object_type: {
	id: "thrown",
	prototype: ["throwable_small_enemy"],
	properties: {
		default_anim: "'hover'",
		acquirable_item_drop_value: "5",					
		points_value: "14",
		physical_size: "8",
	},

	#specifically trigger death here because non-solid objects don't have a water-level
	on_enter_water: "[handle_death({damage_type: 'neutral'}),die()]",
	on_die: "if(me.underwater, null, proto_event('throwable_small_enemy', 'die'))",
	on_return_to_normal: "[proto_event('hittable', 'return_to_normal'), schedule(40,fire_event('warn'))]",
	on_spat: "[proto_event('hittable', 'spat'), set(brightness,255)]",
	animation: [
		{
			image: "enemies/skeeter.png",
			id: "thrown",
			thrown_area: "all",
			duration: 60,
			rect: [47,28,66,51],
			frames: 1,
			body_area: null,
		},
		{
			image: "enemies/skeeter.png",
			id: "on_back",
			rect: [47,28,66,51],
			frames: 2,
			duration: 5,
			body_area: "all",
		},
	],
},
}
