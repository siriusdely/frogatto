{
id: "cannon",
is_strict: true,
prototype: ["standard_values"],
properties: {
	_shoot_counter: { type: "int", default: 0, persistent: false },
	_loading_time: "if(higher_difficulty, 5, 10)",
	material_sound: "'metal'",
},
on_end_anim: "if(animation = 'normal',
	                   if(_shoot_counter >= _loading_time,
					     [animation('fire'), set(_shoot_counter, 0)],
						 [animation('normal'), add(_shoot_counter, 1)]),
					      animation('normal'))",
on_shoot: "[spawn('cannon.missile', midpoint_x+ facing*25, img_mid_y -10, facing,
	           [set(child.velocity_x, 800*facing)]),
	spawn('explosion_spark', midpoint_x+ facing*50, img_mid_y -8, facing)]",
solid_area: [16,6,38,36],
editor_info: {
	category: "enemies, milgramen",
},
animation: [
	{
		id: "normal",
		image: "enemies/cannon.png",
		rect: [3,116,51,154],
		frames: 1,
		duration: 10,
		palettes: "@include data/palettes.cfg:dungeon_palettes",
	},
	{
		id: "fire",
		image: "enemies/cannon.png",
		sound: "cannon.ogg",
		rect: [63,116,111,154],
		frames: 2,
		frames_per_row: 1,
		pad: 3,
		duration: 8,
		events: "5:shoot",
		palettes: "@include data/palettes.cfg:dungeon_palettes",
	},
],
object_type: [
	{
	id: "missile_diag",
	on_collide_side: "animation('explode')",
	on_collide_head: "animation('explode')",
	on_collide_feet: "animation('explode')",
	on_hit_player: "animation('explode')",
	on_end_normal_anim: "animation('normal')",
	on_bang: "spawn('explosion_spark_bright',midpoint_x,midpoint_y,facing)",
	on_end_explode_anim: "die()",
	animation: [
	
		#	solid_area=3,6,14,13
		{
			id: "normal",
			image: "enemies/cannon.png",
			rotate: -45,
			x: 3,
			y: 159,
			w: 19,
			h: 19,
			frames: 2,
			pad: 3,
			duration: 1,
			scale: 2,
			velocity_x: 500,
			velocity_y: -500,
			palettes: "@include data/palettes.cfg:dungeon_palettes",
		},
		{
			id: "explode",
			image: "enemies/cannon.png",
			x: 47,
			y: 162,
			w: 13,
			h: 13,
			frames: 1,
			duration: 10,
			velocity_x: 1,
			velocity_y: 1,
			events: "2:bang",
			palettes: "@include data/palettes.cfg:dungeon_palettes",
		},
	],
	},
	{
		id: "missile_vert",
		on_collide_side: "animation('explode')",
		on_collide_head: "animation('explode')",
		on_collide_feet: "animation('explode')",
		on_hit_player: "animation('explode')",
		on_end_normal_anim: "animation('normal')",
		on_bang: "spawn('explosion_spark_bright',midpoint_x,midpoint_y,facing)",
		on_end_explode_anim: "die()",
		animation: [
		
			#	solid_area=3,6,14,13
			{
				id: "normal",
				image: "enemies/cannon.png",
				rotate: -90,
				x: 3,
				y: 159,
				w: 19,
				h: 19,
				frames: 2,
				pad: 3,
				duration: 1,
				velocity_y: -800,
				palettes: "@include data/palettes.cfg:dungeon_palettes",
			},
			{
				id: "explode",
				image: "enemies/cannon.png",
				x: 47,
				y: 162,
				w: 13,
				h: 13,
				frames: 1,
				duration: 10,
				velocity_x: 1,
				velocity_y: 1,
				events: "2:bang",
				palettes: "@include data/palettes.cfg:dungeon_palettes",
			},
		],
	},
	{
		id: "missile",
		always_active: true,
		object_level_collisions: true,
		prototype: ["shot"],
		on_die: "spawn('explosion', midpoint_x, midpoint_y, facing)",
		animation: {
			id: "normal",
			image: "enemies/cannon.png",
			x: 3,
			y: 159,
			w: 19,
			h: 19,
			frames: 2,
			pad: 3,
			duration: 10000,
			attack_area: "all",
			palettes: "@include data/palettes.cfg:dungeon_palettes",
		},
	},
],
}